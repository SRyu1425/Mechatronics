import csv
import matplotlib.pyplot as plt
import numpy as np
import csv

#pass in a csv file name
#return data and time lists
def parse_csv(signal):
    t = [] # column 0
    data = [] # column 1

    with open(signal) as f:
        # open the csv file
        reader = csv.reader(f)
        for row in reader:
            # read the rows 1 one by one
            t.append(float(row[0])) # leftmost column
            data.append(float(row[1])) # second column

    return t, data

#pass in data list and num of data points to avg
#return a filtered list of data points
def FIR(data, coeffs):
    num = len(coeffs)

    #pad with zeroes to start
    filtered_data = [0] * (num -1)

    for i in range(len(data)):
        if i + num > len(data):
            break  # Ensure we do not go out of bounds
        sum = 0
        k = 0
        for j in range(i, i + num):
            sum += data[j] * coeffs[k]
            k+=1
        filtered_data.append(sum)

    return filtered_data 


#pass in old data and filtered versions
#pass in avg_num 
#return plots
def fft(data, t, f_data, x, freq, bw, wind):
    

    ############ original data ##########
    num_samples = len(t)
    total_time = t[-1] - t[0]
    Fs = int(num_samples / total_time)   # sample rate
    #print(Fs)

    # Ensure that t and data are numpy arrays for compatibility with FFT functions
    t = np.array(t)
    data = np.array(data)
    
    y = data # the data to make the fft from
    n = len(y) # length of the signal
    k = np.arange(n)
    T = n/Fs
    frq = k/T # two sides frequency range
    frq = frq[range(int(n/2))] # one side frequency range
    Y = np.fft.fft(y)/n # fft computing and normalization
    Y = Y[range(int(n/2))]


    ############ filtered data ##########
    num_samples = len(t)
    total_time = t[-1] - t[0]
    Fs = int(num_samples / total_time)   # sample rate

    # Ensure that t and data are numpy arrays for compatibility with FFT functions
    t = np.array(t)
    f_data = np.array(f_data)

    f_data = f_data[:len(data)]

    fy = f_data # the data to make the fft from
    fn = len(fy) # length of the signal
    fk = np.arange(fn)
    fT = fn/Fs
    ffrq = fk/fT # two sides frequency range
    ffrq = ffrq[range(int(fn/2))] # one side frequency range
    fY = np.fft.fft(fy)/fn # fft computing and normalization
    fY = fY[range(int(fn/2))]


    #### plot results ####
    fig, (ax1, ax2) = plt.subplots(2, 1)
    plt.suptitle('FIR with ' + str(x) + ' Different Weights')  # Global title

    ax1.plot(t,fy,'r',  label = 'Filtered', zorder = 2) # plotting the filtered (red)
    ax1.plot(t,y,'k', label= 'Unfiltered', zorder = 1) # plotting the filtered (black)
    ax1.set_xlabel('Time')
    ax1.set_ylabel('Amplitude')
    ax1.set_title('Window Type: ' + wind)
    ax1.legend()

    ax2.loglog(frq,abs(Y),'k', label= 'Unfiltered') # plotting the filtered (black)
    ax2.loglog(ffrq,abs(fY),'r', label = 'Filtered') # plotting the filtered (red)
    ax2.set_xlabel('Freq (Hz)')
    ax2.set_ylabel('|Y(freq)|')
    ax2.set_title('Cutoff Frequency: ' + str(freq) + ', Bandwidth: ' + str(bw))
    ax2.legend()

    plt.tight_layout()
    plt.show()

##### main code #####
#### https://fiiir.com/  - website used to generate unique coeffs for a full FIR 


#first signal unique coeffs
h = [
    0.000000000000000000,
    0.000000022609304456,
    0.000000092137658127,
    0.000000210376981500,
    0.000000378074907886,
    0.000000594900325696,
    0.000000859416815111,
    0.000001169064300580,
    0.000001520149215920,
    0.000001907843452345,
    0.000002326192331196,
    0.000002768131812358,
    0.000003225515116128,
    0.000003689148900478,
    0.000004148839097111,
    0.000004593446468231,
    0.000005010951901591,
    0.000005388531413869,
    0.000005712640781930,
    0.000005969109667889,
    0.000006143245047260,
    0.000006219943689868,
    0.000006183813380806,
    0.000006019302503680,
    0.000005710837540961,
    0.000005242967976715,
    0.000004600518015692,
    0.000003768744460037,
    0.000002733500011260,
    0.000001481401190987,
    0.000000000000000000,
    -0.000001722041638279,
    -0.000003694775675826,
    -0.000005926791075647,
    -0.000008425037448593,
    -0.000011194650419114,
    -0.000014238780007746,
    -0.000017558423373286,
    -0.000021152263307200,
    -0.000025016513915877,
    -0.000029144774962341,
    -0.000033527896366957,
    -0.000038153854386003,
    -0.000043007640996822,
    -0.000048071168018069,
    -0.000053323187482591,
    -0.000058739229758206,
    -0.000064291560877524,
    -0.000069949160491469,
    -0.000075677721802043,
    -0.000081439674757675,
    -0.000087194233709117,
    -0.000092897470625088,
    -0.000098502414854722,
    -0.000103959180298482,
    -0.000109215120710603,
    -0.000114215013704846,
    -0.000118901273871578,
    -0.000123214195238642,
    -0.000127092223121715,
    -0.000130472255212696,
    -0.000133289971547970,
    -0.000135480192783221,
    -0.000136977265978890,
    -0.000137715476871664,
    -0.000137629487373880,
    -0.000136654796805819,
    -0.000134728225127145,
    -0.000131788416194798,
    -0.000127776358837126,
    -0.000122635923299772,
    -0.000116314410389517,
    -0.000108763110419883,
    -0.000099937868848572,
    -0.000089799655293773,
    -0.000078315132425799,
    -0.000065457221054363,
    -0.000051205657571931,
    -0.000035547539771790,
    -0.000018477856937501,
    0.000000000000000000,
    0.000019873752518615,
    0.000041121777108205,
    0.000063712680780720,
    0.000087604913846630,
    0.000112746424287725,
    0.000139074357997619,
    0.000166514809072417,
    0.000194982624214208,
    0.000224381265158973,
    0.000254602732857888,
    0.000285527556926846,
    0.000317024853633430,
    0.000348952455414073,
    0.000381157114607204,
    0.000413474783751794,
    0.000445730974435899,
    0.000477741196287834,
    0.000509311477285098,
    0.000540238966114795,
    0.000570312616856111,
    0.000599313955772492,
    0.000627017929501001,
    0.000653193833411438,
    0.000677606318380946,
    0.000700016473693936,
    0.000720182983235291,
    0.000737863351600188,
    0.000752815196199786,
    0.000764797600901996,
    0.000773572526213876,
    0.000778906270490711,
    0.000780570976149873,
    0.000778346174378884,
    0.000772020361360302,
    0.000761392598594556,
    0.000746274129489374,
    0.000726490004004188,
    0.000701880702793345,
    0.000672303751986134,
    0.000637635319477743,
    0.000597771783385927,
    0.000552631263156265,
    0.000502155103676596,
    0.000446309302690953,
    0.000385085871786737,
    0.000318504121267832,
    0.000246611859321968,
    0.000169486496044106,
    0.000087236043089405,
    0.000000000000000000,
    -0.000092049881420886,
    -0.000188708962926191,
    -0.000289739223627016,
    -0.000394868909070879,
    -0.000503792332330792,
    -0.000616169833229712,
    -0.000731627901163730,
    -0.000849759466277988,
    -0.000970124362994252,
    -0.001092249969091942,
    -0.001215632022708469,
    -0.001339735618754229,
    -0.001463996385336302,
    -0.001587821839857698,
    -0.001710592923510197,
    -0.001831665711913682,
    -0.001950373298678269,
    -0.002066027847682981,
    -0.002177922808881408,
    -0.002285335291466635,
    -0.002387528587259935,
    -0.002483754836236344,
    -0.002573257825170752,
    -0.002655275909486315,
    -0.002729045047518393,
    -0.002793801935577453,
    -0.002848787231408712,
    -0.002893248852910153,
    -0.002926445338288832,
    -0.002947649253212949,
    -0.002956150629958684,
    -0.002951260423060331,
    -0.002932313965553967,
    -0.002898674409562282,
    -0.002849736134704403,
    -0.002784928107632617,
    -0.002703717175899989,
    -0.002605611279351113,
    -0.002490162562303985,
    -0.002356970369955443,
    -0.002205684112696052,
    -0.002036005982363005,
    -0.001847693504890926,
    -0.001640561914339420,
    -0.001414486333881437,
    -0.001169403750025814,
    -0.000905314767118358,
    -0.000622285130015536,
    -0.000320447003749589,
    0.000000000000000001,
    0.000338788058750984,
    0.000695580645376159,
    0.001069972311390398,
    0.001461488752950066,
    0.001869587163870110,
    0.002293656878647479,
    0.002733020307130437,
    0.003186934161098913,
    0.003654590971628138,
    0.004135120894703703,
    0.004627593801148187,
    0.005131021645515233,
    0.005644361107213516,
    0.006166516495748513,
    0.006696342910621199,
    0.007232649645107787,
    0.007774203821870057,
    0.008319734247119286,
    0.008867935468884997,
    0.009417472023829232,
    0.009966982856004428,
    0.010515085889984224,
    0.011060382739907122,
    0.011601463535168466,
    0.012136911842781345,
    0.012665309665806286,
    0.013185242496726660,
    0.013695304404225379,
    0.014194103131501134,
    0.014680265184051732,
    0.015152440884749678,
    0.015609309374042002,
    0.016049583533223350,
    0.016472014808958144,
    0.016875397917563813,
    0.017258575408011220,
    0.017620442063148847,
    0.017959949119311452,
    0.018276108285228888,
    0.018567995542002971,
    0.018834754706865513,
    0.019075600744464558,
    0.019289822810542985,
    0.019476787014068648,
    0.019635938885141990,
    0.019766805537339234,
    0.019868997514539938,
    0.019942210313729766,
    0.019986225576755702,
    0.020000911945533145,
    0.019986225576755702,
    0.019942210313729766,
    0.019868997514539938,
    0.019766805537339234,
    0.019635938885141990,
    0.019476787014068648,
    0.019289822810542985,
    0.019075600744464561,
    0.018834754706865513,
    0.018567995542002971,
    0.018276108285228892,
    0.017959949119311456,
    0.017620442063148851,
    0.017258575408011220,
    0.016875397917563817,
    0.016472014808958144,
    0.016049583533223350,
    0.015609309374042002,
    0.015152440884749678,
    0.014680265184051732,
    0.014194103131501134,
    0.013695304404225379,
    0.013185242496726660,
    0.012665309665806286,
    0.012136911842781345,
    0.011601463535168468,
    0.011060382739907124,
    0.010515085889984224,
    0.009966982856004430,
    0.009417472023829233,
    0.008867935468884999,
    0.008319734247119286,
    0.007774203821870058,
    0.007232649645107790,
    0.006696342910621201,
    0.006166516495748514,
    0.005644361107213516,
    0.005131021645515233,
    0.004627593801148190,
    0.004135120894703703,
    0.003654590971628138,
    0.003186934161098913,
    0.002733020307130436,
    0.002293656878647479,
    0.001869587163870110,
    0.001461488752950066,
    0.001069972311390398,
    0.000695580645376159,
    0.000338788058750984,
    0.000000000000000001,
    -0.000320447003749589,
    -0.000622285130015536,
    -0.000905314767118358,
    -0.001169403750025814,
    -0.001414486333881437,
    -0.001640561914339420,
    -0.001847693504890926,
    -0.002036005982363005,
    -0.002205684112696052,
    -0.002356970369955444,
    -0.002490162562303986,
    -0.002605611279351114,
    -0.002703717175899990,
    -0.002784928107632618,
    -0.002849736134704405,
    -0.002898674409562284,
    -0.002932313965553968,
    -0.002951260423060331,
    -0.002956150629958684,
    -0.002947649253212949,
    -0.002926445338288832,
    -0.002893248852910154,
    -0.002848787231408712,
    -0.002793801935577453,
    -0.002729045047518393,
    -0.002655275909486314,
    -0.002573257825170751,
    -0.002483754836236344,
    -0.002387528587259935,
    -0.002285335291466637,
    -0.002177922808881409,
    -0.002066027847682983,
    -0.001950373298678270,
    -0.001831665711913683,
    -0.001710592923510196,
    -0.001587821839857699,
    -0.001463996385336302,
    -0.001339735618754230,
    -0.001215632022708470,
    -0.001092249969091943,
    -0.000970124362994253,
    -0.000849759466277988,
    -0.000731627901163730,
    -0.000616169833229712,
    -0.000503792332330792,
    -0.000394868909070879,
    -0.000289739223627016,
    -0.000188708962926191,
    -0.000092049881420886,
    0.000000000000000000,
    0.000087236043089405,
    0.000169486496044106,
    0.000246611859321969,
    0.000318504121267832,
    0.000385085871786737,
    0.000446309302690953,
    0.000502155103676596,
    0.000552631263156265,
    0.000597771783385928,
    0.000637635319477744,
    0.000672303751986135,
    0.000701880702793346,
    0.000726490004004188,
    0.000746274129489374,
    0.000761392598594557,
    0.000772020361360302,
    0.000778346174378885,
    0.000780570976149873,
    0.000778906270490711,
    0.000773572526213877,
    0.000764797600901996,
    0.000752815196199787,
    0.000737863351600188,
    0.000720182983235291,
    0.000700016473693937,
    0.000677606318380946,
    0.000653193833411439,
    0.000627017929501001,
    0.000599313955772492,
    0.000570312616856111,
    0.000540238966114796,
    0.000509311477285099,
    0.000477741196287834,
    0.000445730974435899,
    0.000413474783751794,
    0.000381157114607204,
    0.000348952455414074,
    0.000317024853633430,
    0.000285527556926846,
    0.000254602732857889,
    0.000224381265158973,
    0.000194982624214209,
    0.000166514809072417,
    0.000139074357997619,
    0.000112746424287725,
    0.000087604913846630,
    0.000063712680780720,
    0.000041121777108205,
    0.000019873752518615,
    0.000000000000000000,
    -0.000018477856937501,
    -0.000035547539771790,
    -0.000051205657571931,
    -0.000065457221054363,
    -0.000078315132425799,
    -0.000089799655293773,
    -0.000099937868848572,
    -0.000108763110419883,
    -0.000116314410389517,
    -0.000122635923299772,
    -0.000127776358837126,
    -0.000131788416194798,
    -0.000134728225127145,
    -0.000136654796805820,
    -0.000137629487373880,
    -0.000137715476871664,
    -0.000136977265978890,
    -0.000135480192783221,
    -0.000133289971547970,
    -0.000130472255212695,
    -0.000127092223121715,
    -0.000123214195238642,
    -0.000118901273871578,
    -0.000114215013704845,
    -0.000109215120710603,
    -0.000103959180298482,
    -0.000098502414854722,
    -0.000092897470625088,
    -0.000087194233709117,
    -0.000081439674757675,
    -0.000075677721802043,
    -0.000069949160491469,
    -0.000064291560877524,
    -0.000058739229758206,
    -0.000053323187482591,
    -0.000048071168018069,
    -0.000043007640996822,
    -0.000038153854386003,
    -0.000033527896366957,
    -0.000029144774962341,
    -0.000025016513915877,
    -0.000021152263307200,
    -0.000017558423373287,
    -0.000014238780007746,
    -0.000011194650419114,
    -0.000008425037448592,
    -0.000005926791075647,
    -0.000003694775675826,
    -0.000001722041638279,
    0.000000000000000000,
    0.000001481401190987,
    0.000002733500011260,
    0.000003768744460037,
    0.000004600518015692,
    0.000005242967976715,
    0.000005710837540961,
    0.000006019302503680,
    0.000006183813380806,
    0.000006219943689868,
    0.000006143245047260,
    0.000005969109667889,
    0.000005712640781930,
    0.000005388531413869,
    0.000005010951901591,
    0.000004593446468231,
    0.000004148839097111,
    0.000003689148900478,
    0.000003225515116128,
    0.000002768131812358,
    0.000002326192331196,
    0.000001907843452345,
    0.000001520149215920,
    0.000001169064300580,
    0.000000859416815111,
    0.000000594900325696,
    0.000000378074907886,
    0.000000210376981500,
    0.000000092137658127,
    0.000000022609304456,
    0.000000000000000000,
]
t, d = parse_csv('sigA.csv')
fd = FIR(d.copy(), h)
fft(d, t, fd, len(h), 100, 100, 'Blackman')


#second signal unique coeffs
h = [
    -0.000050679794726066,
    -0.000041099278318167,
    -0.000031279920668665,
    -0.000021183486597150,
    -0.000010770285292045,
    0.000000000000000000,
    0.000011167446754809,
    0.000022770999889941,
    0.000034847558259864,
    0.000047431049079466,
    0.000060551498686721,
    0.000074234108254511,
    0.000088498343199344,
    0.000103357045109305,
    0.000118815575023601,
    0.000134870996840645,
    0.000151511309510219,
    0.000168714736477861,
    0.000186449080596567,
    0.000204671152403140,
    0.000223326279275218,
    0.000242347902542027,
    0.000261657269119383,
    0.000281163223679941,
    0.000300762106756334,
    0.000320337763510928,
    0.000339761667195315,
    0.000358893160569588,
    0.000377579817760222,
    0.000395657928211038,
    0.000412953103529159,
    0.000429281007152519,
    0.000444448205872873,
    0.000458253141344113,
    0.000470487218795955,
    0.000480936009263626,
    0.000489380560741255,
    0.000495598812776238,
    0.000499367108150093,
    0.000500461794444300,
    0.000498660907473236,
    0.000493745927786584,
    0.000485503600706003,
    0.000473727809671115,
    0.000458221492033063,
    0.000438798585855176,
    0.000415285995764155,
    0.000387525565446236,
    0.000355376044004699,
    0.000318715033091691,
    0.000277440901501588,
    0.000231474653767861,
    0.000180761739242710,
    0.000125273788160487,
    0.000065010261293197,
    0.000000000000000000,
    -0.000069697336247377,
    -0.000143989957415198,
    -0.000222752767634882,
    -0.000305826338672358,
    -0.000393016043088375,
    -0.000484091357342654,
    -0.000578785344322494,
    -0.000676794323931742,
    -0.000777777739462615,
    -0.000881358226495441,
    -0.000987121890034750,
    -0.001094618794499868,
    -0.001203363670049808,
    -0.001312836837542114,
    -0.001422485353209744,
    -0.001531724372895900,
    -0.001639938734420840,
    -0.001746484755374530,
    -0.001850692242341569,
    -0.001951866706278179,
    -0.002049291777482158,
    -0.002142231812333790,
    -0.002229934682745978,
    -0.002311634738053158,
    -0.002386555927898205,
    -0.002453915073551964,
    -0.002512925274028313,
    -0.002562799432345805,
    -0.002602753886341418,
    -0.002632012127569287,
    -0.002649808591023194,
    -0.002655392497711921,
    -0.002648031731496151,
    -0.002627016731069257,
    -0.002591664377536210,
    -0.002541321857718479,
    -0.002475370483091317,
    -0.002393229444145817,
    -0.002294359479963247,
    -0.002178266442894981,
    -0.002044504738458277,
    -0.001892680620886388,
    -0.001722455325210333,
    -0.001533548017297868,
    -0.001325738543930948,
    -0.001098869965763655,
    -0.000852850856865069,
    -0.000587657355512251,
    -0.000303334951952833,
    0.000000000000000001,
    0.000322159059450752,
    0.000662880773589522,
    0.001021830060775982,
    0.001398597909331569,
    0.001792701398335994,
    0.002203584045179127,
    0.002630616483032971,
    0.003073097469789485,
    0.003530255228366684,
    0.004001249116626688,
    0.004485171623483914,
    0.004981050686118591,
    0.005487852321559077,
    0.006004483564265146,
    0.006529795699742466,
    0.007062587782654920,
    0.007601610426384373,
    0.008145569849526276,
    0.008693132163411565,
    0.009242927883419039,
    0.009793556645595150,
    0.010343592108937170,
    0.010891587022627668,
    0.011436078436539264,
    0.011975593032464911,
    0.012508652552774892,
    0.013033779302562583,
    0.013549501700820601,
    0.014054359855790191,
    0.014546911139352909,
    0.015025735735186426,
    0.015489442135386880,
    0.015936672560369614,
    0.016366108277098043,
    0.016776474791055797,
    0.017166546887869318,
    0.017535153501103896,
    0.017881182383493146,
    0.018203584559716979,
    0.018501378539810983,
    0.018773654273367416,
    0.019019576825867947,
    0.019238389759765797,
    0.019429418204303113,
    0.019592071599501125,
    0.019725846101288819,
    0.019830326636332028,
    0.019905188596781104,
    0.019950199166862841,
    0.019965218274992248,
    0.019950199166862841,
    0.019905188596781104,
    0.019830326636332028,
    0.019725846101288819,
    0.019592071599501125,
    0.019429418204303113,
    0.019238389759765800,
    0.019019576825867947,
    0.018773654273367420,
    0.018501378539810983,
    0.018203584559716979,
    0.017881182383493149,
    0.017535153501103892,
    0.017166546887869318,
    0.016776474791055797,
    0.016366108277098043,
    0.015936672560369614,
    0.015489442135386881,
    0.015025735735186426,
    0.014546911139352912,
    0.014054359855790193,
    0.013549501700820601,
    0.013033779302562583,
    0.012508652552774890,
    0.011975593032464912,
    0.011436078436539264,
    0.010891587022627668,
    0.010343592108937174,
    0.009793556645595150,
    0.009242927883419041,
    0.008693132163411567,
    0.008145569849526276,
    0.007601610426384373,
    0.007062587782654920,
    0.006529795699742466,
    0.006004483564265146,
    0.005487852321559078,
    0.004981050686118592,
    0.004485171623483914,
    0.004001249116626688,
    0.003530255228366684,
    0.003073097469789486,
    0.002630616483032971,
    0.002203584045179127,
    0.001792701398335993,
    0.001398597909331569,
    0.001021830060775982,
    0.000662880773589522,
    0.000322159059450752,
    0.000000000000000001,
    -0.000303334951952833,
    -0.000587657355512251,
    -0.000852850856865070,
    -0.001098869965763655,
    -0.001325738543930948,
    -0.001533548017297868,
    -0.001722455325210333,
    -0.001892680620886389,
    -0.002044504738458278,
    -0.002178266442894981,
    -0.002294359479963247,
    -0.002393229444145818,
    -0.002475370483091317,
    -0.002541321857718479,
    -0.002591664377536210,
    -0.002627016731069256,
    -0.002648031731496151,
    -0.002655392497711923,
    -0.002649808591023195,
    -0.002632012127569288,
    -0.002602753886341418,
    -0.002562799432345805,
    -0.002512925274028314,
    -0.002453915073551965,
    -0.002386555927898205,
    -0.002311634738053157,
    -0.002229934682745978,
    -0.002142231812333790,
    -0.002049291777482159,
    -0.001951866706278179,
    -0.001850692242341569,
    -0.001746484755374531,
    -0.001639938734420841,
    -0.001531724372895900,
    -0.001422485353209745,
    -0.001312836837542114,
    -0.001203363670049807,
    -0.001094618794499867,
    -0.000987121890034750,
    -0.000881358226495441,
    -0.000777777739462615,
    -0.000676794323931742,
    -0.000578785344322494,
    -0.000484091357342654,
    -0.000393016043088375,
    -0.000305826338672358,
    -0.000222752767634882,
    -0.000143989957415198,
    -0.000069697336247377,
    0.000000000000000000,
    0.000065010261293198,
    0.000125273788160487,
    0.000180761739242710,
    0.000231474653767861,
    0.000277440901501588,
    0.000318715033091691,
    0.000355376044004699,
    0.000387525565446236,
    0.000415285995764155,
    0.000438798585855176,
    0.000458221492033064,
    0.000473727809671115,
    0.000485503600706004,
    0.000493745927786584,
    0.000498660907473236,
    0.000500461794444300,
    0.000499367108150093,
    0.000495598812776237,
    0.000489380560741255,
    0.000480936009263626,
    0.000470487218795956,
    0.000458253141344114,
    0.000444448205872873,
    0.000429281007152519,
    0.000412953103529159,
    0.000395657928211038,
    0.000377579817760223,
    0.000358893160569588,
    0.000339761667195315,
    0.000320337763510927,
    0.000300762106756335,
    0.000281163223679941,
    0.000261657269119383,
    0.000242347902542027,
    0.000223326279275218,
    0.000204671152403140,
    0.000186449080596567,
    0.000168714736477861,
    0.000151511309510219,
    0.000134870996840645,
    0.000118815575023601,
    0.000103357045109305,
    0.000088498343199344,
    0.000074234108254511,
    0.000060551498686721,
    0.000047431049079466,
    0.000034847558259864,
    0.000022770999889941,
    0.000011167446754809,
    0.000000000000000000,
    -0.000010770285292045,
    -0.000021183486597150,
    -0.000031279920668665,
    -0.000041099278318167,
    -0.000050679794726066,
]
t, d = parse_csv('sigB.csv')
fd = FIR(d.copy(), h)
fft(d, t, fd, len(h), 33, 33, 'Hamming')

#third signal 
h = [
    0.001867519746044820,
    0.002275293677911463,
    0.002692845467883248,
    0.003119400211540369,
    0.003554151391578438,
    0.003996262853518041,
    0.004444870878876082,
    0.004899086349965267,
    0.005357997000181999,
    0.005820669743355830,
    0.006286153075466025,
    0.006753479541784039,
    0.007221668262275161,
    0.007689727507889525,
    0.008156657320192493,
    0.008621452166627776,
    0.009083103623574271,
    0.009540603079249766,
    0.009992944448431896,
    0.010439126890909214,
    0.010878157525543523,
    0.011309054131818317,
    0.011730847830767882,
    0.012142585737226980,
    0.012543333575412086,
    0.012932178249941664,
    0.013308230364524597,
    0.013670626680692492,
    0.014018532509122373,
    0.014351144026291085,
    0.014667690509420725,
    0.014967436482914990,
    0.015249683769748768,
    0.015513773441556675,
    0.015759087661469738,
    0.015985051414072162,
    0.016191134117190663,
    0.016376851110586923,
    0.016541765016997088,
    0.016685486971350718,
    0.016807677714403370,
    0.016908048547430839,
    0.016986362145057821,
    0.017042433223728004,
    0.017076129063764694,
    0.017087369883420026,
    0.017076129063764694,
    0.017042433223728004,
    0.016986362145057821,
    0.016908048547430839,
    0.016807677714403370,
    0.016685486971350718,
    0.016541765016997088,
    0.016376851110586923,
    0.016191134117190663,
    0.015985051414072162,
    0.015759087661469738,
    0.015513773441556675,
    0.015249683769748768,
    0.014967436482914990,
    0.014667690509420725,
    0.014351144026291085,
    0.014018532509122373,
    0.013670626680692492,
    0.013308230364524597,
    0.012932178249941664,
    0.012543333575412086,
    0.012142585737226980,
    0.011730847830767882,
    0.011309054131818317,
    0.010878157525543523,
    0.010439126890909214,
    0.009992944448431896,
    0.009540603079249766,
    0.009083103623574271,
    0.008621452166627776,
    0.008156657320192493,
    0.007689727507889525,
    0.007221668262275161,
    0.006753479541784039,
    0.006286153075466025,
    0.005820669743355830,
    0.005357997000181999,
    0.004899086349965267,
    0.004444870878876082,
    0.003996262853518041,
    0.003554151391578438,
    0.003119400211540369,
    0.002692845467883248,
    0.002275293677911463,
    0.001867519746044820,
]
t, d = parse_csv('sigC.csv')
fd = FIR(d.copy(), h)
fft(d, t, fd, len(h), 25, 25, 'Rectangular')
h = [
    0.000046148964659494,
    0.000031253518231251,
    0.000015939173809536,
    0.000000000000000000,
    -0.000016776765117865,
    -0.000034607489410039,
    -0.000053708767883492,
    -0.000074293917859975,
    -0.000096569377922474,
    -0.000120731041796713,
    -0.000146960559459936,
    -0.000175421638649285,
    -0.000206256380562296,
    -0.000239581683894518,
    -0.000275485751437942,
    -0.000314024733265143,
    -0.000355219540045984,
    -0.000399052859287032,
    -0.000445466406251138,
    -0.000494358440010956,
    -0.000545581573522501,
    -0.000598940904782560,
    -0.000654192494068027,
    -0.000711042209959584,
    -0.000769144964341627,
    -0.000828104353862216,
    -0.000887472722449816,
    -0.000946751656438001,
    -0.001005392920667018,
    -0.001062799840635108,
    -0.001118329132386897,
    -0.001171293178376172,
    -0.001220962744051587,
    -0.001266570126412796,
    -0.001307312722297756,
    -0.001342357000716331,
    -0.001370842860167674,
    -0.001391888348595497,
    -0.001404594720472449,
    -0.001408051802487577,
    -0.001401343636463754,
    -0.001383554365478402,
    -0.001353774326722871,
    -0.001311106312434229,
    -0.001254671958286917,
    -0.001183618216958171,
    -0.001097123873195613,
    -0.000994406055631440,
    -0.000874726699816307,
    -0.000737398916496420,
    -0.000581793219036025,
    -0.000407343564098822,
    -0.000213553160247499,
    0.000000000000000000,
    0.000233657927908884,
    0.000487677787777061,
    0.000762227447560508,
    0.001057381468580978,
    0.001373117569570795,
    0.001709313597579335,
    0.002065745035274305,
    0.002442083070937597,
    0.002837893254001314,
    0.003252634755317725,
    0.003685660247531689,
    0.004136216416951812,
    0.004603445114224182,
    0.005086385146928551,
    0.005583974712970076,
    0.006095054469360517,
    0.006618371226700490,
    0.007152582255420183,
    0.007696260185639727,
    0.008247898478402250,
    0.008805917442042515,
    0.009368670763610372,
    0.009934452521599612,
    0.010501504642765435,
    0.011068024762573920,
    0.011632174445838068,
    0.012192087721379788,
    0.012745879882136263,
    0.013291656500020453,
    0.013827522603066059,
    0.014351591960950252,
    0.014861996423905316,
    0.015356895259311555,
    0.015834484429915179,
    0.016293005757640359,
    0.016730755917365430,
    0.017146095205807826,
    0.017537456031806932,
    0.017903351075801623,
    0.018242381068160753,
    0.018553242138228222,
    0.018834732688475173,
    0.019085759750994039,
    0.019305344786702837,
    0.019492628891033321,
    0.019646877373529468,
    0.019767483682659039,
    0.019853972651214143,
    0.019906003041918717,
    0.019923369377243216,
    0.019906003041918717,
    0.019853972651214143,
    0.019767483682659039,
    0.019646877373529468,
    0.019492628891033325,
    0.019305344786702837,
    0.019085759750994035,
    0.018834732688475173,
    0.018553242138228222,
    0.018242381068160757,
    0.017903351075801623,
    0.017537456031806935,
    0.017146095205807826,
    0.016730755917365430,
    0.016293005757640363,
    0.015834484429915183,
    0.015356895259311559,
    0.014861996423905319,
    0.014351591960950252,
    0.013827522603066059,
    0.013291656500020455,
    0.012745879882136265,
    0.012192087721379790,
    0.011632174445838068,
    0.011068024762573922,
    0.010501504642765438,
    0.009934452521599614,
    0.009368670763610372,
    0.008805917442042517,
    0.008247898478402252,
    0.007696260185639727,
    0.007152582255420184,
    0.006618371226700488,
    0.006095054469360517,
    0.005583974712970076,
    0.005086385146928551,
    0.004603445114224184,
    0.004136216416951813,
    0.003685660247531690,
    0.003252634755317726,
    0.002837893254001315,
    0.002442083070937599,
    0.002065745035274306,
    0.001709313597579335,
    0.001373117569570795,
    0.001057381468580979,
    0.000762227447560508,
    0.000487677787777061,
    0.000233657927908885,
    0.000000000000000000,
    -0.000213553160247499,
    -0.000407343564098822,
    -0.000581793219036025,
    -0.000737398916496421,
    -0.000874726699816307,
    -0.000994406055631440,
    -0.001097123873195614,
    -0.001183618216958172,
    -0.001254671958286918,
    -0.001311106312434230,
    -0.001353774326722872,
    -0.001383554365478404,
    -0.001401343636463754,
    -0.001408051802487577,
    -0.001404594720472449,
    -0.001391888348595498,
    -0.001370842860167675,
    -0.001342357000716332,
    -0.001307312722297756,
    -0.001266570126412798,
    -0.001220962744051588,
    -0.001171293178376174,
    -0.001118329132386899,
    -0.001062799840635108,
    -0.001005392920667019,
    -0.000946751656438001,
    -0.000887472722449816,
    -0.000828104353862216,
    -0.000769144964341627,
    -0.000711042209959585,
    -0.000654192494068028,
    -0.000598940904782561,
    -0.000545581573522502,
    -0.000494358440010955,
    -0.000445466406251138,
    -0.000399052859287032,
    -0.000355219540045984,
    -0.000314024733265143,
    -0.000275485751437942,
    -0.000239581683894519,
    -0.000206256380562296,
    -0.000175421638649285,      
    -0.000146960559459937,
    -0.000120731041796713,
    -0.000096569377922474,
    -0.000074293917859975,
    -0.000053708767883492,
    -0.000034607489410039,
    -0.000016776765117865,
    0.000000000000000000,
    0.000015939173809536,
    0.000031253518231251,
    0.000046148964659494,
]
t, d = parse_csv('sigD.csv')
fd = FIR(d.copy(), h)
fft(d, t, fd, len(h), 4, 6, 'Hamming')